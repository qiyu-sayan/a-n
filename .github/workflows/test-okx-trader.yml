name: Test OKX Trader

on:
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘

jobs:
  test-okx-trader:
    # ğŸ‘‡ è¿™é‡Œéå¸¸é‡è¦ï¼šç”¨ä½  VPS çš„ self-hosted runner
    # å»ºè®®ç›´æ¥å¤åˆ¶ä½ ç°åœ¨ run-bot.yml é‡Œçš„ runs-on é…ç½®
    runs-on: self-hosted

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'  # æˆ–è€…ä½ ç°åœ¨æœºå™¨äººç”¨çš„ç‰ˆæœ¬

      - name: Install dependencies
        # å¦‚æœä½ é¡¹ç›®æœ‰ requirements.txt å°±ç”¨è¿™ä¸€è¡Œ
        # æ²¡æœ‰çš„è¯ï¼Œå¯ä»¥æš‚æ—¶æ”¹æˆ "pip install requests"
        run: |
          if [ -f requirements.txt ]; then
            pip install -r requirements.txt
          else
            pip install requests
          fi

      - name: Run test_okx_trader
        env:
          OKX_API_KEY: ${{ secrets.OKX_PAPER_API_KEY }}
          OKX_API_SECRET: ${{ secrets.OKX_PAPER_API_SECRET }}
          OKX_API_PASSPHRASE: ${{ secrets.OKX_PAPER_API_PASSPHRASE }}
        run: |
          python bot/test_okx_trader.py

